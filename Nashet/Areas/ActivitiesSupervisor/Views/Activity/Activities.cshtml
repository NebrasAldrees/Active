@using Nashet.Business.ViewModels
@model IEnumerable<ActivityViewModel>
<section class="page_wrap">
    <div class="page_content">
        <div class="block mb-4">
            <div class="block-header border-bottom px-4 py-3">
                <h5 class="m-0">الأنشطة</h5>
                <div class="d-flex gap-2">
                    <div class="form-group">
                        <input type="text" class="form-control table__quick_search"
                               placeholder="البحث السريع ...">
                    </div>
                    <a asp-action="InsertActivity" asp-controller="Activity" asp-area="ActivitiesSupervisor" class="btn btn-primary">إضافة نشاط</a>
                </div>
            </div>
            <div class="block-body">
                <!-- Start Card -->
                <div class="row" id="activitesContainer">
                    @foreach (var item in Model)
                    {
                        <div class="col-md-6 col-lg-4 mb-4 club-card">
                            <div class="card h-100">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0" style="ustify-content: center;">@item.ActivityTopic</h6>
                                </div>
                                <div class="card-body">
                                    <!-- Activity poster-->
                                    <div class="text-center mb-3">
                                        @if (!string.IsNullOrEmpty(item.ActivityPoster))
                                        {
                                            <img src="@item.ActivityPoster" alt="إعلان النشاط"
                                                 style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                                        }
                                        else
                                        {
                                            <div style="width: 80px; height: 80px; background: #f8f9fa; border-radius: 8px; display: inline-flex; align-items: center; justify-content: center;">
                                                <i class="fas fa-image text-muted"></i>
                                            </div>
                                        }
                                    </div>

                                    <!-- Activity Info-->

                                    <div class="mb-2">
                                        <strong>النادي:</strong>
                                        @{
                                            var Clubs = ViewBag.Clubs as List<ClubViewModel>;
                                            var club = Clubs?.FirstOrDefault(c => c.Guid == item.ClubGuid);
                                        }
                                        <p class="mb-1 text-muted">@(club?.ClubNameAR ?? "غير محدد")</p>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <div class="action_td text-center">
                                        <a href="@Url.Action("ActivityPage", "Activity", new { area = "ActivitiesSupervisor", guid = item.Guid })"
                                           class="btn btn-sm btn-primary">عرض</a>
                                        <a asp-action="UpdateActivity" asp-controller="Activity" asp-route-id="@item.Guid" class="btn btn-sm btn-success">تعديل</a>
                                        <a asp-action="DeleteActivity" asp-controller="Activity" asp-route-guid="@item.Guid" class="btn btn-sm btn-danger"
                                           onclick="return confirm('هل أنت متأكد من أنك تريد حذف هذا النشاط؟')">حذف </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
                <!-- End card-->
            </div>
        </div>

    </div>
</section><!-- End Page Wrap -->
@section Scripts {
    <script>
        document.getElementById('ActivitySearch').addEventListener('input', function(e) {
            const searchText = e.target.value.toLowerCase().trim();
            const activityCards = document.querySelectorAll('.activity-card');

            activityCards.forEach(card => {
                const cardText = card.textContent.toLowerCase();
                if (cardText.includes(searchText) || searchText === '') {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });
    </script>
}