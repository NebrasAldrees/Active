@model IEnumerable<ReportViewModel>
<section class="page_wrap">
    <div class="page_content">
        <div class="block mb-4">
            <div class="block-header border-bottom px-4 py-3">
                <h5 class="m-0">التقارير</h5>
            </div>
            <div class="block-body">
                <table class="table table-hover js-dataTable">
                    <thead>
                        <tr>
                            <th>الرقم المرجعي للتقرير</th>
                            <th>عنوان التقرير</th>
                            <th class=""></th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            foreach (var item in Model)
                            {
                                <tr class="cursor-pointer" goto="order_details.html">
                                    <td>@item.ReportId</td>
                                    <td>@item.Topic</td>
                                    <td class="action_td text-end">
                                        <a href="@item.Path" download class="btn btn-sm btn-success download-btn" title="تنزيل التقرير" data-filename="@item.Topic">
                                            <i class="fas fa-download me-1"></i>تنزيل التقرير
                                        </a>
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.querySelectorAll('.download-btn').forEach(button => {
            button.addEventListener('click', function(e) {
                const fileName = this.getAttribute('data-filename');

                Swal.fire({
                    title: "تم تنزيل الملف بنجاح!",
                    text: `تم تنزيل التقرير: ${fileName}`,
                    icon: "success",
                    confirmButtonText: "موافق",
                    timer: 3000,
                    timerProgressBar: true,
                    draggable: true
                });
            });
        });

    </script>
}